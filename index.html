<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>AASHIR's Assignment</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.min.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Delicious+Handrawn&display=swap" rel="stylesheet">
    
    <style>
      body {
        font-family: 'Delicious Handrawn', cursive;
        font-size: 20px;
        background-color: rgb(222, 238, 165);
      }

    </style>
    
  </head>

  
  <body>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg " style=" font-size: 22px;">
    <div class="container">
      <a class="navbar-brand " style="font-size: 30px;" href="#">AASHIR's SPA</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item mx-2">
            <a class="nav-link" href="#home">Home</a>
          </li>
          <li class="nav-item mx-2">
            <a class="nav-link" href="#table">Data Table</a>
          </li>
          <li class="nav-item mx-2">
            <a class="nav-link" href="#addData">Data Form</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Content -->
  <div class="container mt-5" id="home" >
      <div class="container p-10 " style="margin-top: 10rem; margin-bottom: 10rem; ">
        <div class="row my-5">
          <div class="col-md-12 text-center my-5">
            <h1 class="hero-title" style="font-size: 56px;">Welcome to Aashir's API Assignment.</h1>
            <p class="hero-subtitle my-5" style="font-size: 26px;">
              In this Assignment I will fill a table with data from an API endpoint. <br/>
              I will then update, delete and add more data to the table by using AJAX/JQUERY Form.
            </p>
            <a href="#" class="btn btn-primary btn-lg" style="background-color: rgb(156, 172, 95); border: rgb(156, 172, 95);">Get Started</a>
          </div>
        </div>
      </div>
   
    
    <!-- TABLE -->
    <div id="table">
      <h1 class="text-center mb-5 font-weight-bold" >API DATA Table</h1>
      <table class="table table-striped table-hover"   style="border: rgb(156, 172, 95); font-size: 24px;">
        <thead style="background-color:rgb(156, 172, 95); font-size: 28px;">
          <tr >
            <th id="id-header">ID</th>
            <th id="name-header">Name</th>
            <th id="username-header">Username</th>
            <th id="email-header">Email</th>
            <th id="phone-header">Phone</th>
            <th id="website-header">Website</th>
            <th></th>
          </tr>
        </thead>
        <tbody id="table-body">
        </tbody>
      </table>
    </div>
    <!-- <button class="btn btn-primary" onclick="addRow()">Add Row</button> -->

    <!-- FORM -->
    <div class="text-center" id="addData">
    <button 
      class="btn btn-primary btn-lg my-5"  
      style="background-color: rgb(156, 172, 95); border: rgb(156, 172, 95); align-self: center;"
      id="show-form">Show Form</button>
    </div>
    <div class="row">
      <div class="mx-auto col-10 col-md-8 col-lg-6">
        <div id="form-container"  style="display: none; font-size: 28px;">
          <form id="user-form"  method="post">
              <div class="form-group mb-3 ">
                  <label for="name">Name</label>
                  <input type="text" class="form-control" id="name" name="name" required>
              </div>
              <div class="form-group mb-3 ">
                  <label for="username text-left">Username</label>
                  <input type="text" class="form-control" id="username" name="username" required>
              </div>
              <div class="form-group mb-3 ">
                  <label for="email">Email</label>
                  <input type="email" class="form-control" id="email" name="email" required>
              </div>
              <div class="form-group mb-3">
                  <label for="phone">Phone</label>
                  <input type="tel" class="form-control" id="phone" name="phone" required>
              </div>
              <div class="form-group mb-3 ">
                  <label for="website">Website</label>
                  <input type="url" class="form-control" id="website" name="website" required>
              </div>
              <div class="text-center">
                <button type="submit" class="btn btn-primary btn-lg my-5"  
                style="background-color: rgb(156, 172, 95); border: rgb(156, 172, 95); align-self: center;">Submit</button>
              </div>
          </form>
        </div>
      </div>
    </div>


  </div>

  <!-- Footer -->
  <footer class="text-center text-lg-start p-4" style=" margin-top: 10px;">
    <div class="text-center p-3">
      Â© 2023 Aashir Aftab: All rights reserved
    </div>
  </footer>
    

  <!-- Include Bootstrap JS and jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <script>
    $(function() {
        $('#user-form').submit(function(event) {
            event.preventDefault();

            // serialize the form data
            var formData = $(this).serialize();

            // make an ajax request to post the form data to the API
            $.ajax({
                url: 'https://jsonplaceholder.typicode.com/users/',
                type: 'POST',
                data: formData,
                success: function(response) {
                    // clear the form fields
                    $('#user-form')[0].reset();

                    // reload the table data
                    loadTableData();
                },
                error: function(xhr, status, error) {
                    console.log(xhr.responseText);
                }
            });
        });
    });

    function loadTableData() {
        // make an ajax request to get the data from the API
        $.ajax({
            url: 'https://jsonplaceholder.typicode.com/users/',
            type: 'GET',
            dataType: 'json',
            success: function(response) {
                // build the table rows
                var rows = '';
                $.each(response, function(index, user) {
                    rows += '<tr>';
                    rows += '<td>' + user.id + '</td>';
                    rows += '<td>' + user.name + '</td>';
                    rows += '<td>' + user.username + '</td>';
                    rows += '<td>' + user.email + '</td>';
                    rows += '<td>' + user.phone + '</td>';
                    rows += '<td>' + user.website + '</td>';
                    rows += '</tr>';
                });

                // update the table body with the new rows
                $('#table-body').html(rows);
            },
            error: function(xhr, status, error) {
                console.log(xhr.responseText);
            }
        });
    }

    // load the table data on page load
    loadTableData();
  </script>

 <script>
  // toggle form on button click
  $("#show-form").click(function() {
      $("#form-container").slideToggle();
      $(this).text(function(i, text){
        return text === "Show Form" ? "Hide Form" : "Show Form";
      });
    });


   // make API request and populate table
   $.ajax({
     url: "https://jsonplaceholder.typicode.com/users",
     dataType: "json",
     success: function(data) {
       var sortedColumn = null;
       var sortOrder = -1;

       // function to sort the data based on a specific column
       function sortTable(column) {
         sortedColumn = column;
         sortOrder = -sortOrder;
         data.sort(function(a, b) {
           var comparison = 0;
           if (a[column] > b[column]) {
             comparison = 1;
           } else if (a[column] < b[column]) {
             comparison = -1;
           }
           return sortOrder * comparison;
         });
       }

       // function to populate the table with the sorted data
       function populateTable() {
         $("#table-body ").empty();

         $.each(data, function(index, value) {
           var row = $("<tr>");
           $("<td></td>").text(value.id).appendTo(row);
           $("<td></td>").text(value.name).appendTo(row);
           $("<td></td>").text(value.username).appendTo(row);
           $("<td></td>").text(value.email).appendTo(row);
           $("<td></td>").text(value.phone).appendTo(row);
           $("<td></td>").text(value.website).appendTo(row);
    //      // add Edit button to row
    // $("<td></td>").append("<button class='btn btn-primary btn-sm edit-btn' data-id='" + user.id + "'>Edit</button>").appendTo(row);
          // add Delete button to row
          $("<td></td>").append("<button class='btn btn-dark btn-sm delete-btn' data-id='" + value.id +"' '>Delete</button>").appendTo(row);
          $("#table-body").append(row);
         });
        
         // delete record on button click
        $(".delete-btn").click(function() {
          var id = $(this).data("id");
          // var confirmDelete = confirm("Are you sure you want to delete this record?");
          // if (confirmDelete) {
          //   data = data.filter(function(user) {
          //     return user.id !== id;
          //   });
          //   populateTable();
          // }
          deleteRecord(id);
        });
       }

       // initial table population
       populateTable();

       function deleteRecord(id) {
        var confirmDelete = confirm("Are you sure you want to delete this record?");
        if (confirmDelete) {
          $.ajax({
            url: "https://jsonplaceholder.typicode.com/users/" + id,
            type: "DELETE",
            success: function(result) {
              // Remove deleted record from data array
              data = data.filter(function(user) {
                return user.id !== id;
              });
              // Repopulate table with updated data
              populateTable();
            },
            error: function(jqXHR, textStatus, errorThrown) {
              console.log(textStatus + ": " + errorThrown);
            }
          });
        }
      }

       // sort table on header click
       $("#id-header").click(function() {
         sortTable("id");
         populateTable();
       });
       $("#name-header").click(function() {
         sortTable("name");
         populateTable();
       });
       $("#username-header").click(function() {
         sortTable("username");
         populateTable();
       });
       $("#email-header").click(function() {
         sortTable("email");
         populateTable();
       });
       $("#phone-header").click(function() {
         sortTable("phone");
         populateTable();
       });
       $("#website-header").click(function() {
         sortTable("website");
         populateTable();
       });
     }
   });

    
     
           
   
 </script>
  </body>
</html>